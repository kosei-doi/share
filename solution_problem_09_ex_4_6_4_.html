<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微分積分 09 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }

        .strategy {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #333;
        }

        .strategy-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 20px;
            text-align: center;
            color: #000;
        }

        .knowledge {
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ccc;
        }

        .knowledge-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #333;
        }

        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
        }

        .flowchart-step {
            background: #f0f0f0;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px 0;
            min-width: 250px;
            max-width: 600px;
            text-align: center;
            font-size: 0.95em;
            position: relative;
        }

        .flowchart-step.start {
            background: #e3f2fd;
            border-color: #1976d2;
        }

        .flowchart-step.process {
            background: #fff3e0;
            border-color: #f57c00;
        }

        .flowchart-step.decision {
            background: #f3e5f5;
            border-color: #7b1fa2;
        }

        .flowchart-step.end {
            background: #e8f5e9;
            border-color: #388e3c;
        }

        .flowchart-arrow {
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 15px solid #333;
            margin: 5px 0;
        }

        .flowchart-label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>微分積分 09 解答</h1>
        
        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>次の関数の極値を調べよ。</p>
            <p>（1）$f(x,y)=4xy-2y^{2}-x^{4}$</p>
        </div>
        
        <div class="strategy">
            <div class="strategy-title">【方針】</div>
            
            <div class="knowledge">
                <div class="knowledge-title">必要な知識・テクニック</div>
                <ul>
                    <li><strong>偏微分</strong>：2変数関数 $f(x,y)$ の $x$ に関する偏微分 $f_{x}(x,y)$ は、$y$ を定数として $x$ で微分したものです。同様に、$y$ に関する偏微分 $f_{y}(x,y)$ は、$x$ を定数として $y$ で微分したものです。</li>
                    <li><strong>停留点</strong>：$f_{x}(x,y) = 0$ かつ $f_{y}(x,y) = 0$ を満たす点 $(x,y)$ を停留点といいます。極値は停留点でのみ現れる可能性がありますが、すべての停留点が極値であるとは限りません。</li>
                    <li><strong>2階偏導関数</strong>：$f_{xx} = \frac{\partial^{2}f}{\partial x^{2}}$、$f_{yy} = \frac{\partial^{2}f}{\partial y^{2}}$、$f_{xy} = \frac{\partial^{2}f}{\partial x \partial y}$ を2階偏導関数といいます。$f_{xy} = f_{yx}$ が成り立ちます（連続な場合）。</li>
                    <li><strong>ヘッセ行列の判別式</strong>：$D = (f_{xy})^{2} - f_{xx}f_{yy}$ を判別式といいます。停留点 $(a,b)$ において、$D(a,b) < 0$ のとき極値の可能性があり、$D(a,b) > 0$ のとき極値ではありません（鞍点）。$D(a,b) = 0$ のときは判別式だけでは判定できません。</li>
                    <li><strong>極値の判定</strong>：停留点 $(a,b)$ において、$D(a,b) < 0$ かつ $f_{xx}(a,b) > 0$ のとき極小、$D(a,b) < 0$ かつ $f_{xx}(a,b) < 0$ のとき極大となります。</li>
                </ul>
            </div>
            
            <div class="flowchart">
                <div class="flowchart-step start">
                    <div class="flowchart-label">開始</div>
                    関数の極値を調べる
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">ステップ1</div>
                    1階偏導関数 $f_{x}$、$f_{y}$ を計算する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">ステップ2</div>
                    $f_{x} = 0$、$f_{y} = 0$ を解き、停留点を求める
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">ステップ3</div>
                    2階偏導関数 $f_{xx}$、$f_{yy}$、$f_{xy}$ を計算する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">ステップ4</div>
                    判別式 $D = (f_{xy})^{2} - f_{xx}f_{yy}$ を計算する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step decision">
                    <div class="flowchart-label">判定</div>
                    各停留点で判別式の符号を調べる
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">$D > 0$ の場合</div>
                    極値でない（鞍点）
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">$D < 0$ の場合</div>
                    $f_{xx}$ の符号から極大・極小を判定する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step end">
                    <div class="flowchart-label">終了</div>
                    極値の結果をまとめる
                </div>
            </div>
        </div>
        
        <h2>【解答】</h2>
        <p>この問題では、まず1階偏導関数を計算して停留点を求め、次に2階偏導関数とヘッセ行列の判別式を用いて各停留点での極値の判定を行います。判別式が正の場合は鞍点、負の場合は $f_{xx}$ の符号から極大・極小を判定します。</p>
        
        <div class="step">
            <div class="step-title">（1）関数 $f(x,y)=4xy-2y^{2}-x^{4}$ について</div>
            <p>まず、1階偏導関数を計算します。$f(x,y) = 4xy - 2y^{2} - x^{4}$ について、$x$ に関する偏微分 $f_{x}(x,y)$ を計算します。$y$ を定数として $x$ で微分します。</p>
            
            <p>$4xy$ を $x$ で偏微分すると $4y$ です。$-2y^{2}$ は $x$ を含まないため、$x$ で偏微分すると $0$ です。$-x^{4}$ を $x$ で偏微分すると $-4x^{3}$ です。したがって、</p>
            
            <div class="formula">
                $$f_{x}(x,y) = 4y - 4x^{3}$$
            </div>
            
            <p>となります。</p>
            
            <p>次に、$y$ に関する偏微分 $f_{y}(x,y)$ を計算します。$x$ を定数として $y$ で微分します。</p>
            
            <p>$4xy$ を $y$ で偏微分すると $4x$ です。$-2y^{2}$ を $y$ で偏微分すると $-4y$ です。$-x^{4}$ は $y$ を含まないため、$y$ で偏微分すると $0$ です。したがって、</p>
            
            <div class="formula">
                $$f_{y}(x,y) = 4x - 4y$$
            </div>
            
            <p>となります。</p>
            
            <p>次に、停留点を求めます。停留点は $f_{x}(x,y) = 0$ かつ $f_{y}(x,y) = 0$ を満たす点です。したがって、連立方程式</p>
            
            <div class="formula">
                $$\begin{cases} f_{x}(x,y) = 4y - 4x^{3} = 0 \\ f_{y}(x,y) = 4x - 4y = 0 \end{cases}$$
            </div>
            
            <p>を解きます。</p>
            
            <p>まず、$f_{y}(x,y) = 0$ より、</p>
            
            <div class="formula">
                $$4x - 4y = 0$$
            </div>
            
            <p>となります。両辺を $4$ で割ると、</p>
            
            <div class="formula">
                $$x - y = 0$$
            </div>
            
            <p>すなわち、</p>
            
            <div class="formula">
                $$y = x$$
            </div>
            
            <p>となります。</p>
            
            <p>次に、$f_{x}(x,y) = 0$ に $y = x$ を代入します。したがって、</p>
            
            <div class="formula">
                $$4x - 4x^{3} = 0$$
            </div>
            
            <p>となります。両辺を $4$ で割ると、</p>
            
            <div class="formula">
                $$x - x^{3} = 0$$
            </div>
            
            <p>となります。左辺を因数分解すると、</p>
            
            <div class="formula">
                $$x(1 - x^{2}) = 0$$
            </div>
            
            <p>となります。さらに因数分解すると、</p>
            
            <div class="formula">
                $$x(1-x)(1+x) = 0$$
            </div>
            
            <p>となります。したがって、$x = 0$、$x = 1$、$x = -1$ です。</p>
            
            <div class="note">
                <strong>補足：</strong> $1 - x^{2} = (1-x)(1+x)$ という因数分解公式を用いました。これは $a^{2} - b^{2} = (a-b)(a+b)$ という公式の応用です。
            </div>
            
            <p>$y = x$ であるため、対応する $y$ の値は、$x = 0$ のとき $y = 0$、$x = 1$ のとき $y = 1$、$x = -1$ のとき $y = -1$ です。</p>
            
            <p>したがって、極値候補（停留点）は、$(0,0)$、$(1,1)$、$(-1,-1)$ です。</p>
            
            <p>次に、2階偏導関数を計算します。まず、$f_{xx}(x,y)$ を計算します。$f_{x}(x,y) = 4y - 4x^{3}$ を $x$ で偏微分すると、</p>
            
            <div class="formula">
                $$f_{xx}(x,y) = \frac{\partial}{\partial x}(4y - 4x^{3}) = 0 - 4 \cdot 3x^{2} = -12x^{2}$$
            </div>
            
            <p>となります。ここで、$4y$ は $x$ を含まないため、$x$ で偏微分すると $0$ です。$-4x^{3}$ を $x$ で偏微分すると $-12x^{2}$ です。</p>
            
            <p>次に、$f_{yy}(x,y)$ を計算します。$f_{y}(x,y) = 4x - 4y$ を $y$ で偏微分すると、</p>
            
            <div class="formula">
                $$f_{yy}(x,y) = \frac{\partial}{\partial y}(4x - 4y) = 0 - 4 = -4$$
            </div>
            
            <p>となります。ここで、$4x$ は $y$ を含まないため、$y$ で偏微分すると $0$ です。$-4y$ を $y$ で偏微分すると $-4$ です。</p>
            
            <p>次に、$f_{xy}(x,y)$ を計算します。$f_{x}(x,y) = 4y - 4x^{3}$ を $y$ で偏微分すると、</p>
            
            <div class="formula">
                $$f_{xy}(x,y) = \frac{\partial}{\partial y}(4y - 4x^{3}) = 4 - 0 = 4$$
            </div>
            
            <p>となります。ここで、$4y$ を $y$ で偏微分すると $4$ です。$-4x^{3}$ は $y$ を含まないため、$y$ で偏微分すると $0$ です。</p>
            
            <div class="note">
                <strong>補足：</strong> $f_{xy} = f_{yx}$ が成り立ちます（連続な場合）。確認のため、$f_{y}(x,y) = 4x - 4y$ を $x$ で偏微分すると、$f_{yx}(x,y) = 4 - 0 = 4$ となり、$f_{xy} = f_{yx} = 4$ が確認できます。
            </div>
            
            <p>次に、ヘッセ行列の判別式 $D$ を計算します。判別式は、</p>
            
            <div class="formula">
                $$D = (f_{xy})^{2} - f_{xx}f_{yy}$$
            </div>
            
            <p>で定義されます。$f_{xx} = -12x^{2}$、$f_{yy} = -4$、$f_{xy} = 4$ であるため、</p>
            
            <div class="formula">
                $$D = 4^{2} - (-12x^{2})(-4) = 16 - 48x^{2}$$
            </div>
            
            <p>となります。ここで、$(-12x^{2})(-4) = 48x^{2}$ であることを用いました。</p>
            
            <p>各停留点での判別式の値と極値の判定を行います。</p>
            
            <p>まず、$(0,0)$ について、</p>
            
            <div class="formula">
                $$D(0,0) = 16 - 48 \cdot 0^{2} = 16 - 0 = 16 > 0$$
            </div>
            
            <p>となります。判別式が正であるため、$(0,0)$ は極値ではありません。この点は鞍点（saddle point）です。</p>
            
            <div class="note">
                <strong>補足：</strong> 鞍点とは、ある方向では極大、別の方向では極小となる点です。判別式が正の場合は、その停留点は極値ではありません。
            </div>
            
            <p>次に、$(1,1)$ について、</p>
            
            <div class="formula">
                $$D(1,1) = 16 - 48 \cdot 1^{2} = 16 - 48 = -32 < 0$$
            </div>
            
            <p>となります。判別式が負であるため、$(1,1)$ は極値の可能性があります。次に、$f_{xx}(1,1)$ の符号を調べます。</p>
            
            <div class="formula">
                $$f_{xx}(1,1) = -12 \cdot 1^{2} = -12 < 0$$
            </div>
            
            <p>となります。$f_{xx}(1,1) < 0$ であるため、$(1,1)$ は極大です。</p>
            
            <div class="note">
                <strong>補足：</strong> 判別式が負で $f_{xx} < 0$ のとき極大、$f_{xx} > 0$ のとき極小となります。これは、2次形式の符号から判定できます。
            </div>
            
            <p>極大値は、</p>
            
            <div class="formula">
                $$f(1,1) = 4(1)(1) - 2(1)^{2} - (1)^{4} = 4 - 2 - 1 = 1$$
            </div>
            
            <p>となります。</p>
            
            <p>最後に、$(-1,-1)$ について、</p>
            
            <div class="formula">
                $$D(-1,-1) = 16 - 48(-1)^{2} = 16 - 48 = -32 < 0$$
            </div>
            
            <p>となります。ここで、$(-1)^{2} = 1$ であることを用いました。判別式が負であるため、$(-1,-1)$ は極値の可能性があります。次に、$f_{xx}(-1,-1)$ の符号を調べます。</p>
            
            <div class="formula">
                $$f_{xx}(-1,-1) = -12(-1)^{2} = -12 \cdot 1 = -12 < 0$$
            </div>
            
            <p>となります。$f_{xx}(-1,-1) < 0$ であるため、$(-1,-1)$ は極大です。</p>
            
            <p>極大値は、</p>
            
            <div class="formula">
                $$f(-1,-1) = 4(-1)(-1) - 2(-1)^{2} - (-1)^{4} = 4 - 2 - 1 = 1$$
            </div>
            
            <p>となります。ここで、$(-1)(-1) = 1$、$(-1)^{2} = 1$、$(-1)^{4} = 1$ であることを用いました。</p>
        </div>
        
        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>計算した内容を検証します。</p>
            
            <p>まず、偏導関数の計算を確認します。$f(x,y) = 4xy - 2y^{2} - x^{4}$ について、$f_{x}(x,y) = 4y - 4x^{3}$、$f_{y}(x,y) = 4x - 4y$ は正しいです。2階偏導関数について、$f_{xx}(x,y) = -12x^{2}$、$f_{yy}(x,y) = -4$、$f_{xy}(x,y) = 4$ も正しいです。判別式 $D = 16 - 48x^{2}$ も正しく計算されています。</p>
            
            <p>次に、停留点の計算を確認します。$f_{x} = 0$ より $4y - 4x^{3} = 0$、$f_{y} = 0$ より $4x - 4y = 0$ すなわち $y = x$ です。$y = x$ を $4y - 4x^{3} = 0$ に代入すると $4x - 4x^{3} = 0$ となり、$x(1-x^{2}) = 0$ から $x = 0, \pm 1$ が得られます。したがって、停留点は $(0,0)$、$(1,1)$、$(-1,-1)$ です。この計算は正しいです。</p>
            
            <p>各停留点での判定を確認します。$(0,0)$ では $D = 16 > 0$ であるため鞍点です。$(1,1)$ では $D = -32 < 0$ かつ $f_{xx} = -12 < 0$ であるため極大で、$f(1,1) = 1$ です。$(-1,-1)$ では $D = -32 < 0$ かつ $f_{xx} = -12 < 0$ であるため極大で、$f(-1,-1) = 1$ です。すべての計算は正しいです。</p>
            
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
        
        <div class="answer-box">
            <div class="answer-title">【答】</div>
            <p>（1）$f(x,y)=4xy-2y^{2}-x^{4}$ について：</p>
            <p>停留点は $(0,0)$、$(1,1)$、$(-1,-1)$ です。</p>
            <p>$(0,0)$ は極値ではありません（鞍点）。判別式 $D(0,0) = 16 > 0$ であるためです。</p>
            <p>$(1,1)$ は極大で、極大値は $f(1,1) = 1$ です。判別式 $D(1,1) = -32 < 0$ かつ $f_{xx}(1,1) = -12 < 0$ であるためです。</p>
            <p>$(-1,-1)$ は極大で、極大値は $f(-1,-1) = 1$ です。判別式 $D(-1,-1) = -32 < 0$ かつ $f_{xx}(-1,-1) = -12 < 0$ であるためです。</p>
        </div>
    </div>
</body>
</html>
