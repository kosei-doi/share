<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微分積分 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>微分積分 問１解答</h1>

        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>次の2変数関数の極値を調べます。</p>
            <div class="formula">
                $$f(x,y) = x^4 + y^4 - x^2 - 2xy - y^2 + 3$$
            </div>
        </div>

        <h2>【解答】</h2>

        <div class="step">
            <div class="step-title">（1）極値の候補点を求めます。</div>
            <p>2変数関数の極値を求めるには、まず偏導関数を計算して、それらが同時に0になる点（臨界点）を求めます。これが極値の候補点となります。</p>
            <p>まず、$f(x,y)$ を $x$ について偏微分します。$y$ を定数とみなして微分するので、</p>
            <div class="formula">
                $$f_x(x,y) = \frac{\partial f}{\partial x} = 4x^3 - 2x - 2y$$
            </div>
            <p>となります。次に、$f(x,y)$ を $y$ について偏微分します。$x$ を定数とみなして微分するので、</p>
            <div class="formula">
                $$f_y(x,y) = \frac{\partial f}{\partial y} = 4y^3 - 2y - 2x$$
            </div>
            <p>となります。</p>
            <p>極値の候補点は、$f_x(x,y) = 0$ かつ $f_y(x,y) = 0$ を満たす点です。すなわち、</p>
            <div class="formula">
                $$\begin{cases} 4x^3 - 2x - 2y = 0 \quad \cdots (1) \\ 4y^3 - 2y - 2x = 0 \quad \cdots (2) \end{cases}$$
            </div>
            <p>この連立方程式を解きます。式(1)から $y$ について解くと、</p>
            <div class="calculation">
                $$4x^3 - 2x - 2y = 0$$
                $$2y = 4x^3 - 2x$$
                $$y = 2x^3 - x$$
            </div>
            <p>この $y = 2x^3 - x$ を式(2)に代入します。</p>
            <div class="calculation">
                $$4(2x^3 - x)^3 - 2(2x^3 - x) - 2x = 0$$
            </div>
            <p>この方程式を整理して解きます。$(2x^3 - x)^3$ を展開するのは複雑なので、代わりに式(1)と式(2)の対称性に注目します。式(1)と式(2)は $x$ と $y$ を入れ替えた形になっているので、$x = y$ または $x = -y$ の場合を考えます。</p>
            <p>まず、$x = y$ の場合を考えます。式(1)に $y = x$ を代入すると、</p>
            <div class="calculation">
                $$4x^3 - 2x - 2x = 0$$
                $$4x^3 - 4x = 0$$
                $$4x(x^2 - 1) = 0$$
                $$4x(x-1)(x+1) = 0$$
            </div>
            <p>したがって、$x = 0, 1, -1$ が得られます。$y = x$ なので、対応する $y$ の値は $y = 0, 1, -1$ です。</p>
            <p>次に、$x = -y$ の場合を考えます。式(1)に $y = -x$ を代入すると、</p>
            <div class="calculation">
                $$4x^3 - 2x - 2(-x) = 0$$
                $$4x^3 - 2x + 2x = 0$$
                $$4x^3 = 0$$
                $$x = 0$$
            </div>
            <p>したがって、$x = 0, y = 0$ が得られますが、これは既に得られています。</p>
            <p>以上より、極値の候補点は $(0,0)$、$(1,1)$、$(-1,-1)$ の3点です。</p>
            <div class="note">
                <p>偏導関数が同時に0になる点を臨界点といいます。臨界点は極値の候補となりますが、必ずしも極値であるとは限りません。次のステップで、各臨界点が実際に極値かどうかを判定します。</p>
            </div>
        </div>

        <div class="step">
            <div class="step-title">（2）2階偏導関数とヘッセ行列を計算します。</div>
            <p>各候補点が極値かどうかを判定するために、2階偏導関数を計算します。2変数関数の場合、ヘッセ行列の行列式（判別式）を用いて判定します。</p>
            <p>まず、2階偏導関数を計算します。</p>
            <div class="formula">
                $$f_{xx}(x,y) = \frac{\partial^2 f}{\partial x^2} = 12x^2 - 2$$
            </div>
            <div class="formula">
                $$f_{yy}(x,y) = \frac{\partial^2 f}{\partial y^2} = 12y^2 - 2$$
            </div>
            <div class="formula">
                $$f_{xy}(x,y) = f_{yx}(x,y) = \frac{\partial^2 f}{\partial x \partial y} = -2$$
            </div>
            <p>ここで、$f_{xy} = f_{yx}$ となるのは、$f$ が連続な2階偏導関数を持つためです。</p>
            <p>ヘッセ行列の行列式（判別式）$D$ は、</p>
            <div class="formula">
                $$D(x,y) = f_{xx}(x,y) f_{yy}(x,y) - (f_{xy}(x,y))^2 = (12x^2 - 2)(12y^2 - 2) - (-2)^2$$
            </div>
            <p>となります。</p>
            <div class="note">
                <p>極値の判定には、以下の判定法を用います：</p>
                <ul>
                    <li>$D > 0$ かつ $f_{xx} > 0$ のとき：極小値</li>
                    <li>$D > 0$ かつ $f_{xx} < 0$ のとき：極大値</li>
                    <li>$D < 0$ のとき：極値ではない（鞍点）</li>
                    <li>$D = 0$ のとき：判定不能（別の方法で調べる必要がある）</li>
                </ul>
            </div>
        </div>

        <div class="step">
            <div class="step-title">（3）各候補点での極値判定を行います。</div>
            <p>各候補点 $(0,0)$、$(1,1)$、$(-1,-1)$ について、判別式と2階偏導関数の値を計算して極値かどうかを判定します。</p>
            
            <p><strong>点 $(1,1)$ について：</strong></p>
            <div class="calculation">
                $$f_{xx}(1,1) = 12 \cdot 1^2 - 2 = 10 > 0$$
                $$f_{yy}(1,1) = 12 \cdot 1^2 - 2 = 10$$
                $$f_{xy}(1,1) = -2$$
                $$D(1,1) = 10 \cdot 10 - (-2)^2 = 100 - 4 = 96 > 0$$
            </div>
            <p>$D(1,1) > 0$ かつ $f_{xx}(1,1) > 0$ なので、$(1,1)$ は極小値の点です。このときの関数値は、</p>
            <div class="calculation">
                $$f(1,1) = 1^4 + 1^4 - 1^2 - 2 \cdot 1 \cdot 1 - 1^2 + 3 = 1 + 1 - 1 - 2 - 1 + 3 = 1$$
            </div>
            <p>となります。したがって、$(1,1)$ で極小値 $f(1,1) = 1$ をとります。</p>

            <p><strong>点 $(-1,-1)$ について：</strong></p>
            <div class="calculation">
                $$f_{xx}(-1,-1) = 12 \cdot (-1)^2 - 2 = 10 > 0$$
                $$f_{yy}(-1,-1) = 12 \cdot (-1)^2 - 2 = 10$$
                $$f_{xy}(-1,-1) = -2$$
                $$D(-1,-1) = 10 \cdot 10 - (-2)^2 = 100 - 4 = 96 > 0$$
            </div>
            <p>$D(-1,-1) > 0$ かつ $f_{xx}(-1,-1) > 0$ なので、$(-1,-1)$ も極小値の点です。このときの関数値は、</p>
            <div class="calculation">
                $$f(-1,-1) = (-1)^4 + (-1)^4 - (-1)^2 - 2 \cdot (-1) \cdot (-1) - (-1)^2 + 3 = 1 + 1 - 1 - 2 - 1 + 3 = 1$$
            </div>
            <p>となります。したがって、$(-1,-1)$ で極小値 $f(-1,-1) = 1$ をとります。</p>

            <p><strong>点 $(0,0)$ について：</strong></p>
            <div class="calculation">
                $$f_{xx}(0,0) = 12 \cdot 0^2 - 2 = -2 < 0$$
                $$f_{yy}(0,0) = 12 \cdot 0^2 - 2 = -2$$
                $$f_{xy}(0,0) = -2$$
                $$D(0,0) = (-2) \cdot (-2) - (-2)^2 = 4 - 4 = 0$$
            </div>
            <p>$D(0,0) = 0$ なので、判別式による判定ができません。この場合、別の方法で $(0,0)$ が極値かどうかを調べる必要があります。</p>
        </div>

        <div class="step">
            <div class="step-title">（4）点 $(0,0)$ が極値かどうかを詳しく調べます。</div>
            <p>判別式が $0$ の場合、$(0,0)$ の近くでの関数の挙動を直接調べる必要があります。$(0,0)$ が極値であるためには、$(0,0)$ の十分近くのすべての点 $(x,y)$ で $f(x,y) \geq f(0,0)$（極小値の場合）または $f(x,y) \leq f(0,0)$（極大値の場合）が成り立つ必要があります。</p>
            <p>まず、$f(0,0)$ の値を計算します。</p>
            <div class="calculation">
                $$f(0,0) = 0^4 + 0^4 - 0^2 - 2 \cdot 0 \cdot 0 - 0^2 + 3 = 3$$
            </div>
            <p>次に、$(0,0)$ に異なる方向から近づいたときの関数の値を調べます。</p>
            
            <p><strong>方向1：$y = 0$（$x$ 軸上）に沿って近づく場合</strong></p>
            <p>$y = 0$ を代入すると、</p>
            <div class="formula">
                $$f(x,0) = x^4 - x^2 + 3 = x^2(x^2 - 1) + 3$$
            </div>
            <p>となります。$x$ が十分小さいとき（例えば $|x| < 1$ のとき）、$x^2 - 1 < 0$ なので、$x^2(x^2 - 1) < 0$ となります。したがって、</p>
            <div class="calculation">
                $$f(x,0) = x^2(x^2 - 1) + 3 < 3 = f(0,0)$$
            </div>
            <p>となり、$(0,0)$ の近くに $f(x,y) < f(0,0)$ となる点が存在します。</p>

            <p><strong>方向2：$y = -x$ に沿って近づく場合</strong></p>
            <p>$y = -x$ を代入すると、</p>
            <div class="formula">
                $$f(x,-x) = x^4 + (-x)^4 - x^2 - 2x(-x) - (-x)^2 + 3$$
            </div>
            <p>各項を計算します。$(-x)^4 = x^4$、$(-x)^2 = x^2$ なので、</p>
            <div class="calculation">
                $$f(x,-x) = x^4 + x^4 - x^2 - 2x(-x) - x^2 + 3$$
                $$= 2x^4 - x^2 + 2x^2 - x^2 + 3$$
                $$= 2x^4 + 3$$
            </div>
            <p>となります。$x \neq 0$ のとき、$2x^4 > 0$ なので、</p>
            <div class="calculation">
                $$f(x,-x) = 2x^4 + 3 > 3 = f(0,0)$$
            </div>
            <p>となり、$(0,0)$ の近くに $f(x,y) > f(0,0)$ となる点が存在します。</p>

            <p><strong>結論：</strong></p>
            <p>$(0,0)$ のどんなに近くにも、$f(x,y) < f(0,0)$ となる点（$y = 0$ 上の点）と $f(x,y) > f(0,0)$ となる点（$y = -x$ 上の点）が存在します。これは、$(0,0)$ が極値ではないことを意味します。このような点を鞍点といいます。</p>
            <div class="note">
                <p>鞍点とは、ある方向から見ると極大値のように見え、別の方向から見ると極小値のように見える点のことです。$(0,0)$ は、$x$ 軸方向から見ると極大値のように見えますが、$y = -x$ 方向から見ると極小値のように見えます。したがって、$(0,0)$ は極値ではなく、鞍点です。</p>
            </div>
        </div>

        <div class="answer-box">
            <div class="answer-title">【答え】</div>
            <p>関数 $f(x,y) = x^4 + y^4 - x^2 - 2xy - y^2 + 3$ の極値は以下の通りです。</p>
            <div class="explanation">
                <p><strong>極小値：</strong></p>
                <ul>
                    <li>点 $(1,1)$ で極小値 $f(1,1) = 1$ をとります。</li>
                    <li>点 $(-1,-1)$ で極小値 $f(-1,-1) = 1$ をとります。</li>
                </ul>
                <p><strong>極値ではない点：</strong></p>
                <ul>
                    <li>点 $(0,0)$ は鞍点であり、極値ではありません（$f(0,0) = 3$）。</li>
                </ul>
                <p><strong>最大値：</strong></p>
                <ul>
                    <li>最大値は存在しません（$x \to \infty$ または $y \to \infty$ のとき $f(x,y) \to \infty$ となるため）。</li>
                </ul>
            </div>
        </div>

        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>求めた結果が正しいことを確認します。</p>
            
            <p>まず、偏導関数が正しく計算されていることを確認します。</p>
            <div class="calculation">
                <p>$f_x(x,y) = 4x^3 - 2x - 2y$ を $x$ で偏微分すると、</p>
                <p>$f_{xx}(x,y) = 12x^2 - 2$</p>
                <p>これは正しいです。</p>
            </div>
            <div class="calculation">
                <p>$f_y(x,y) = 4y^3 - 2y - 2x$ を $y$ で偏微分すると、</p>
                <p>$f_{yy}(x,y) = 12y^2 - 2$</p>
                <p>これも正しいです。</p>
            </div>
            <div class="calculation">
                <p>$f_x(x,y)$ を $y$ で偏微分すると、</p>
                <p>$f_{xy}(x,y) = -2$</p>
                <p>これも正しく計算されています。</p>
            </div>
            
            <p>次に、極値の判定が正しいことを確認します。</p>
            <div class="calculation">
                <p><strong>点 $(1,1)$ について：</strong></p>
                <p>$D(1,1) = 96 > 0$ かつ $f_{xx}(1,1) = 10 > 0$ なので、極小値であることが確認できます。</p>
                <p>実際、$f(1,1) = 1^4 + 1^4 - 1^2 - 2 \cdot 1 \cdot 1 - 1^2 + 3 = 1$ となり、これは正しい値です。</p>
            </div>
            <div class="calculation">
                <p><strong>点 $(-1,-1)$ について：</strong></p>
                <p>$D(-1,-1) = 96 > 0$ かつ $f_{xx}(-1,-1) = 10 > 0$ なので、極小値であることが確認できます。</p>
                <p>実際、$f(-1,-1) = (-1)^4 + (-1)^4 - (-1)^2 - 2 \cdot (-1) \cdot (-1) - (-1)^2 + 3 = 1$ となり、これも正しい値です。</p>
            </div>
            <div class="calculation">
                <p><strong>点 $(0,0)$ について：</strong></p>
                <p>$y = 0$ のとき $f(x,0) = x^2(x^2 - 1) + 3 < 3 = f(0,0)$（$|x| < 1$ のとき）</p>
                <p>$y = -x$ のとき $f(x,-x) = 2x^4 + 3 > 3 = f(0,0)$（$x \neq 0$ のとき）</p>
                <p>したがって、$(0,0)$ の近くに $f(x,y) < f(0,0)$ となる点と $f(x,y) > f(0,0)$ となる点が存在するため、$(0,0)$ は極値ではなく鞍点であることが確認できます。</p>
            </div>
            
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
    </div>
</body>
</html>

