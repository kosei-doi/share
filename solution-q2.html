<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微分積分 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>微分積分 問2解答</h1>

        <h2>【解答】</h2>

        <div class="problem">
            <div class="problem-title">【問題】極値をしらべよ</div>
            <p>対象となる関数は $f(x,y) = x^4 + y^4 - x^2 - 2xy - y^2 + 3$ です。全ての臨界点を求め、その点で極大・極小・鞍点を判定します。</p>
        </div>

        <div class="step">
            <div class="step-title">（1）停留点を求めます。</div>
            
            <p>極値の候補となる点は、勾配 $\nabla f = (f_x, f_y)$ がゼロベクトルになる点です。まず、$x$ と $y$ について偏微分を計算します。</p>

            <div class="formula">
                $$f_x = \frac{\partial f}{\partial x} = 4x^3 - 2x - 2y$$
            </div>

            <p>$x$ について偏微分する際は、$y$ を定数として扱います。$x^4$ の導関数は $4x^3$、$-x^2$ の導関数は $-2x$、$-2xy$ の導関数は $-2y$（$y$ は定数なので）、その他の項は $x$ を含まないため導関数は $0$ になります。</p>

            <div class="formula">
                $$f_y = \frac{\partial f}{\partial y} = 4y^3 - 2y - 2x$$
            </div>

            <p>同様に、$y$ について偏微分する際は $x$ を定数として扱います。$y^4$ の導関数は $4y^3$、$-y^2$ の導関数は $-2y$、$-2xy$ の導関数は $-2x$（$x$ は定数なので）になります。</p>

            <p>停留点を求めるため、$f_x = 0$ かつ $f_y = 0$ となる連立方程式を解きます。</p>

            <div class="formula">
                $$\begin{cases} 4x^3 - 2x - 2y = 0 \\ 4y^3 - 2y - 2x = 0 \end{cases}$$
            </div>

            <p>この連立方程式は左右対称な形をしています。第1式から第2式を引くと、$4(x^3 - y^3) - 2(x - y) = 0$ となり、因数分解すると $(x-y)(4(x^2+xy+y^2) - 2) = 0$ が得られます。ここで $x = y$ の場合を考えると、第1式に代入して $4x^3 - 2x - 2x = 4x^3 - 4x = 0$ となります。</p>

            <div class="calculation">
                $$4x^3 - 4x = 4x(x^2 - 1) = 4x(x-1)(x+1) = 0$$
            </div>

            <p>したがって $x = 0, 1, -1$ が得られ、$x = y$ より停留点の候補は $(0,0), (1,1), (-1,-1)$ となります。</p>

            <div class="note">
                対称性を利用することで計算が簡単になります。対称性がない場合は、代入法や消去法を用いて全ての解を調べる必要があります。ここでは $x = y$ の場合のみを調べましたが、実際には他の解が存在しないことを確認する必要があります。しかし、この問題では $x = y$ の場合のみが解となることが分かります。
            </div>
        </div>

        <div class="step">
            <div class="step-title">（2）ヘッセ行列を用いて $(1,1)$ と $(-1,-1)$ を判定します。</div>
            
            <p>停留点が極値かどうかを判定するため、二次偏導関数を計算してヘッセ行列の判別式 $D = f_{xx}f_{yy} - (f_{xy})^2$ を求めます。判別式 $D$ と $f_{xx}$ の符号によって、極大・極小・鞍点を判定できます。</p>

            <p>まず、二次偏導関数を計算します。$f_x = 4x^3 - 2x - 2y$ を $x$ で偏微分すると、</p>

            <div class="formula">
                $$f_{xx} = \frac{\partial^2 f}{\partial x^2} = 12x^2 - 2$$
            </div>

            <p>$f_x$ を $y$ で偏微分すると、</p>

            <div class="formula">
                $$f_{xy} = \frac{\partial^2 f}{\partial x \partial y} = -2$$
            </div>

            <p>$f_y = 4y^3 - 2y - 2x$ を $y$ で偏微分すると、</p>

            <div class="formula">
                $$f_{yy} = \frac{\partial^2 f}{\partial y^2} = 12y^2 - 2$$
            </div>

            <p>点 $(1,1)$ における各二次偏導関数の値を計算します。</p>

            <div class="calculation">
                $$f_{xx}(1,1) = 12 \times 1^2 - 2 = 12 - 2 = 10$$
                $$f_{yy}(1,1) = 12 \times 1^2 - 2 = 12 - 2 = 10$$
                $$f_{xy}(1,1) = -2$$
            </div>

            <p>判別式 $D(1,1)$ を計算します。</p>

            <div class="calculation">
                $$D(1,1) = f_{xx}(1,1) \times f_{yy}(1,1) - (f_{xy}(1,1))^2 = 10 \times 10 - (-2)^2 = 100 - 4 = 96 > 0$$
            </div>

            <p>判別式が正（$D > 0$）で、かつ $f_{xx}(1,1) = 10 > 0$ であるため、$(1,1)$ は極小値をとります。</p>

            <p>同様に、点 $(-1,-1)$ における各二次偏導関数の値を計算します。</p>

            <div class="calculation">
                $$f_{xx}(-1,-1) = 12 \times (-1)^2 - 2 = 12 - 2 = 10$$
                $$f_{yy}(-1,-1) = 12 \times (-1)^2 - 2 = 12 - 2 = 10$$
                $$f_{xy}(-1,-1) = -2$$
            </div>

            <p>判別式 $D(-1,-1)$ を計算します。</p>

            <div class="calculation">
                $$D(-1,-1) = 10 \times 10 - (-2)^2 = 100 - 4 = 96 > 0$$
            </div>

            <p>判別式が正（$D > 0$）で、かつ $f_{xx}(-1,-1) = 10 > 0$ であるため、$(-1,-1)$ も極小値をとります。</p>

            <p>極小値の値を計算します。$(1,1)$ における関数値を求めると、</p>

            <div class="calculation">
                $$f(1,1) = 1^4 + 1^4 - 1^2 - 2 \times 1 \times 1 - 1^2 + 3 = 1 + 1 - 1 - 2 - 1 + 3 = 2$$
            </div>

            <p>同様に $f(-1,-1) = 2$ となります。</p>

            <div class="note">
                判別式 $D$ と $f_{xx}$ の符号による判定基準は以下の通りです。$D > 0$ かつ $f_{xx} > 0$ なら極小値、$D > 0$ かつ $f_{xx} < 0$ なら極大値、$D < 0$ なら鞍点、$D = 0$ の場合は判定保留となり、別の方法で調べる必要があります。
            </div>
        </div>

        <div class="step">
            <div class="step-title">（3）$D=0$ となる $(0,0)$ を別の方法で調べます。</div>
            
            <p>点 $(0,0)$ における各二次偏導関数の値を計算します。</p>

            <div class="calculation">
                $$f_{xx}(0,0) = 12 \times 0^2 - 2 = -2$$
                $$f_{yy}(0,0) = 12 \times 0^2 - 2 = -2$$
                $$f_{xy}(0,0) = -2$$
            </div>

            <p>判別式 $D(0,0)$ を計算します。</p>

            <div class="calculation">
                $$D(0,0) = f_{xx}(0,0) \times f_{yy}(0,0) - (f_{xy}(0,0))^2 = (-2) \times (-2) - (-2)^2 = 4 - 4 = 0$$
            </div>

            <p>判別式が $0$ のため、ヘッセ行列による判定では極値かどうかを判断できません。この場合、異なる方向に沿って関数値の変化を直接調べる必要があります。</p>

            <p>まず、$y = 0$（$x$ 軸上）に沿って $(0,0)$ に近づく場合を調べます。このとき関数は $f(x,0)$ となります。</p>

            <div class="formula">
                $$f(x,0) = x^4 + 0^4 - x^2 - 2x \times 0 - 0^2 + 3 = x^4 - x^2 + 3$$
            </div>

            <p>この式を因数分解の形に変形します。</p>

            <div class="formula">
                $$f(x,0) = x^4 - x^2 + 3 = x^2(x^2 - 1) + 3$$
            </div>

            <p>$|x|$ が十分小さいとき（例えば $|x| < 1$ のとき）、$x^2 - 1 < 0$ となるため、$x^2(x^2 - 1) < 0$ が成り立ちます。したがって、$f(x,0) = x^2(x^2 - 1) + 3 < 3 = f(0,0)$ となります。つまり、$(0,0)$ の近くに、$(0,0)$ より関数値が小さい点が存在します。</p>

            <p>次に、$y = -x$ に沿って $(0,0)$ に近づく場合を調べます。このとき関数は $f(x,-x)$ となります。</p>

            <div class="formula">
                $$f(x,-x) = x^4 + (-x)^4 - x^2 - 2x(-x) - (-x)^2 + 3$$
            </div>

            <p>計算を進めます。</p>

            <div class="calculation">
                $$f(x,-x) = x^4 + x^4 - x^2 + 2x^2 - x^2 + 3 = 2x^4 + 3$$
            </div>

            <p>$x \neq 0$ のとき、$2x^4 > 0$ であるため、$f(x,-x) = 2x^4 + 3 > 3 = f(0,0)$ が成り立ちます。つまり、$(0,0)$ の近くに、$(0,0)$ より関数値が大きい点が存在します。</p>

            <p>以上より、$(0,0)$ のどんなに近くにも、$f(x,y) < f(0,0)$ となる点と $f(x,y) > f(0,0)$ となる点の両方が存在します。したがって、$(0,0)$ は極値ではなく、鞍点であることが分かります。</p>

            <div class="note">
                判別式が $0$ のときは、ヘッセ行列による判定だけでは不十分です。異なる方向に沿った制限関数を評価して、極値かどうかを確かめる必要があります。一方向だけを見ると誤判定につながるため、複数の方向を調べることが重要です。
            </div>
        </div>

        <div class="answer-box">
            <div class="answer-title">【最終結果】</div>
            
            <p>停留点は $(1,1), (-1,-1), (0,0)$ の3点です。</p>

            <p>$(1,1)$ と $(-1,-1)$ は、判別式が正（$D = 96 > 0$）で $f_{xx} > 0$ であるため、いずれも極小値をとります。極小値は $f(1,1) = f(-1,-1) = 2$ です。</p>

            <p>$(0,0)$ では判別式が $0$ となるため、方向を変えて調べたところ、近傍により大きい値と小さい値の両方が存在することが分かりました。したがって、$(0,0)$ は極値ではなく鞍点です。</p>

            <p>関数 $f(x,y) = x^4 + y^4 - x^2 - 2xy - y^2 + 3$ には、四次の正の項 $x^4 + y^4$ があるため、$x \to \infty$ または $y \to \infty$ のとき $f \to \infty$ となります。したがって、有限の最大値は存在しません。</p>
        </div>

        <div class="verification">
            <div class="verification-title">検証</div>
            
            <p>まず、求めた3点すべてで勾配がゼロになることを確認します。勾配の条件 $f_x = 0$ かつ $f_y = 0$ に各点を代入して検証します。</p>

            <p>点 $(1,1)$ では、$f_x(1,1) = 4 \times 1^3 - 2 \times 1 - 2 \times 1 = 4 - 2 - 2 = 0$、$f_y(1,1) = 4 \times 1^3 - 2 \times 1 - 2 \times 1 = 4 - 2 - 2 = 0$ となり、勾配がゼロであることを確認できます。同様に、$(-1,-1)$ でも $f_x(-1,-1) = 4 \times (-1)^3 - 2 \times (-1) - 2 \times (-1) = -4 + 2 + 2 = 0$、$f_y(-1,-1) = 0$ となり、$(0,0)$ でも $f_x(0,0) = 0$、$f_y(0,0) = 0$ となります。</p>

            <p>次に、$(0,0)$ が鞍点であることを再確認します。$y = 0$ の方向では、$x = 0.5$ のとき $f(0.5, 0) = 0.5^4 - 0.5^2 + 3 = 0.0625 - 0.25 + 3 = 2.8125 < 3 = f(0,0)$ となり、$f(0,0)$ より小さい値が存在します。一方、$y = -x$ の方向では、$x = 0.5$ のとき $f(0.5, -0.5) = 2 \times 0.5^4 + 3 = 2 \times 0.0625 + 3 = 3.125 > 3 = f(0,0)$ となり、$f(0,0)$ より大きい値が存在します。これにより、$(0,0)$ の近傍に上下両方向の値が存在することが確認でき、鞍点であることが確かめられます。</p>

            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>

    </div>
</body>
</html>
