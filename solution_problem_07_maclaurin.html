<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>微分積分 07 解答</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', 'Yu Mincho', 'YuMincho', 'Hiragino Mincho ProN', serif;
            line-height: 2;
            color: #000;
            background: #fafafa;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 50px 60px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h1 {
            color: #000;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 1.8em;
            text-align: center;
        }

        h2 {
            color: #000;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.4em;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }

        .problem {
            background: #fff;
            padding: 20px;
            margin: 30px 0;
            border: 1px solid #000;
        }

        .problem-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .step {
            background: #fff;
            padding: 20px;
            margin: 25px 0;
            border-left: 3px solid #000;
            padding-left: 25px;
        }

        .step-title {
            font-weight: bold;
            font-size: 1.05em;
            margin-bottom: 15px;
        }

        .formula {
            background: #fff;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
            overflow-x: auto;
        }

        .explanation {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 2px solid #666;
            padding-left: 20px;
        }

        .answer-box {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #000;
        }

        .answer-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
        }

        .verification {
            background: #fff;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #666;
        }

        .verification-title {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .calculation {
            margin: 10px 0;
            padding: 10px;
            border-left: 2px solid #ccc;
            padding-left: 15px;
        }

        .note {
            background: #fff;
            padding: 12px;
            margin: 15px 0;
            border: 1px dashed #666;
            font-size: 0.95em;
        }

        p {
            margin: 10px 0;
            text-align: justify;
        }

        .solution-number {
            font-weight: bold;
            margin-right: 10px;
        }

        .strategy {
            background: #fff;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #333;
        }

        .strategy-title {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 20px;
            text-align: center;
            color: #000;
        }

        .knowledge {
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #ccc;
        }

        .knowledge-title {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 15px;
            color: #333;
        }

        .flowchart {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
        }

        .flowchart-step {
            background: #f0f0f0;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 15px 20px;
            margin: 10px 0;
            min-width: 250px;
            max-width: 600px;
            text-align: center;
            font-size: 0.95em;
            position: relative;
        }

        .flowchart-step.start {
            background: #e3f2fd;
            border-color: #1976d2;
        }

        .flowchart-step.process {
            background: #fff3e0;
            border-color: #f57c00;
        }

        .flowchart-step.decision {
            background: #f3e5f5;
            border-color: #7b1fa2;
        }

        .flowchart-step.end {
            background: #e8f5e9;
            border-color: #388e3c;
        }

        .flowchart-arrow {
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 15px solid #333;
            margin: 5px 0;
        }

        .flowchart-label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>微分積分 07 解答</h1>
        
        <div class="problem">
            <div class="problem-title">【問題】</div>
            <p>次の関数をマクローリン展開せよ。</p>
            <p>（1）$f(x,y)=e^{x}\log(1+y)$（原点の近くで、2次まで）</p>
            <p>（2）$f(x,y)=\sin(x+y^{2})$（4次まで）</p>
        </div>
        
        <div class="strategy">
            <div class="strategy-title">【方針】</div>
            
            <div class="knowledge">
                <div class="knowledge-title">必要な知識・テクニック</div>
                <ul>
                    <li><strong>マクローリン展開</strong>：関数 $f(x)$ を $x=0$ の周りでテイラー展開したものをマクローリン展開といいます。2変数関数 $f(x,y)$ の場合も、$(x,y)=(0,0)$ の周りで展開します。マクローリン展開は、$f(x,y) = \sum_{n=0}^{\infty} \frac{1}{n!}\left(x\frac{\partial}{\partial x} + y\frac{\partial}{\partial y}\right)^{n}f(0,0)$ の形で表されますが、通常は既知の1変数関数の展開を利用します。</li>
                    <li><strong>指数関数のマクローリン展開</strong>：$e^{x} = 1 + x + \frac{1}{2!}x^{2} + \frac{1}{3!}x^{3} + \cdots = \sum_{n=0}^{\infty} \frac{x^{n}}{n!}$ です。この展開はすべての実数 $x$ に対して成り立ちます。</li>
                    <li><strong>対数関数のマクローリン展開</strong>：$\log(1+y) = y - \frac{1}{2}y^{2} + \frac{1}{3}y^{3} - \frac{1}{4}y^{4} + \cdots = \sum_{n=1}^{\infty} \frac{(-1)^{n-1}}{n}y^{n}$ です。この展開は $|y| < 1$ の範囲で成り立ちます。</li>
                    <li><strong>三角関数のマクローリン展開</strong>：$\sin t = t - \frac{1}{3!}t^{3} + \frac{1}{5!}t^{5} - \cdots = \sum_{n=0}^{\infty} \frac{(-1)^{n}}{(2n+1)!}t^{2n+1}$ です。この展開はすべての実数 $t$ に対して成り立ちます。</li>
                    <li><strong>積の展開</strong>：2つの関数の積 $f(x,y) \cdot g(x,y)$ をマクローリン展開する場合、それぞれの関数を展開してから掛け算し、必要な次数まで集めます。次数の低い項から順に計算していきます。</li>
                    <li><strong>次数の概念</strong>：2変数関数 $f(x,y)$ のマクローリン展開において、項 $x^{m}y^{n}$ の次数は $m+n$ です。例えば、$xy$ は1次、$x^{2}y$ は3次、$x^{2}y^{2}$ は4次です。</li>
                </ul>
            </div>
            
            <div class="flowchart">
                <div class="flowchart-step start">
                    <div class="flowchart-label">開始</div>
                    各関数について、マクローリン展開を求める
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">問題（1）</div>
                    $e^{x}$ と $\log(1+y)$ のマクローリン展開を確認する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">問題（1）</div>
                    2つの展開を掛け算し、2次の項までを集める
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">問題（2）</div>
                    $x+y^{2}=t$ とおき、$\sin t$ のマクローリン展開を確認する
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step process">
                    <div class="flowchart-label">問題（2）</div>
                    $t = x+y^{2}$ を代入し、4次の項までを集める
                </div>
                <div class="flowchart-arrow"></div>
                <div class="flowchart-step end">
                    <div class="flowchart-label">終了</div>
                    各関数のマクローリン展開の結果をまとめる
                </div>
            </div>
        </div>
        
        <h2>【解答】</h2>
        <p>この問題では、2つの関数について、マクローリン展開を求めます。問題（1）では、$e^{x}$ と $\log(1+y)$ の既知のマクローリン展開を利用して、それらの積を展開し、2次の項までを求めます。問題（2）では、$x+y^{2}=t$ とおいて $\sin t$ のマクローリン展開を利用し、4次の項までを求めます。</p>
        
        <div class="step">
            <div class="step-title">（1）$f(x,y)=e^{x}\log(1+y)$ について（2次まで）</div>
            <p>まず、$e^{x}$ と $\log(1+y)$ のマクローリン展開を確認します。</p>
            
            <p>$e^{x}$ のマクローリン展開は、</p>
            
            <div class="formula">
                $$e^{x} = 1 + x + \frac{1}{2!}x^{2} + \frac{1}{3!}x^{3} + \cdots = 1 + x + \frac{1}{2}x^{2} + \frac{1}{6}x^{3} + \cdots$$
            </div>
            
            <p>です。ここで、$2! = 2$、$3! = 6$ であることを用いました。</p>
            
            <p>次に、$\log(1+y)$ のマクローリン展開は、</p>
            
            <div class="formula">
                $$\log(1+y) = y - \frac{1}{2}y^{2} + \frac{1}{3}y^{3} - \frac{1}{4}y^{4} + \cdots$$
            </div>
            
            <p>です。</p>
            
            <div class="note">
                <strong>補足：</strong> $\log(1+y)$ のマクローリン展開は、$|y| < 1$ の範囲で成り立ちます。原点の近くで展開するため、この条件は満たされます。
            </div>
            
            <p>2次の項までを求めるため、$e^{x}$ は2次まで、$\log(1+y)$ は2次まで展開します。したがって、</p>
            
            <div class="formula">
                $$e^{x} = 1 + x + \frac{1}{2}x^{2} + \cdots$$
            </div>
            
            <p>および</p>
            
            <div class="formula">
                $$\log(1+y) = y - \frac{1}{2}y^{2} + \cdots$$
            </div>
            
            <p>です。ここで、$\cdots$ は3次以上の項を表します。</p>
            
            <p>次に、これらを掛け算します。$f(x,y) = e^{x}\log(1+y)$ であるため、</p>
            
            <div class="formula">
                $$f(x,y) = \left(1 + x + \frac{1}{2}x^{2} + \cdots\right)\left(y - \frac{1}{2}y^{2} + \cdots\right)$$
            </div>
            
            <p>となります。この積を展開する際は、2次の項までを集めます。各項の次数を確認しながら計算します。</p>
            
            <p>まず、定数項（0次）はありません。次に、1次の項を求めます。1次の項は、$1 \cdot y = y$ のみです。</p>
            
            <p>次に、2次の項を求めます。2次の項は、以下の組み合わせから生じます：</p>
            
            <ul>
                <li>$x \cdot y = xy$（$x$ の1次と $y$ の1次の積で、合計2次）</li>
                <li>$1 \cdot \left(-\frac{1}{2}y^{2}\right) = -\frac{1}{2}y^{2}$（定数と $y$ の2次の積で、合計2次）</li>
            </ul>
            
            <p>したがって、2次の項は $xy - \frac{1}{2}y^{2}$ です。</p>
            
            <div class="note">
                <strong>補足：</strong> $\frac{1}{2}x^{2} \cdot y$ は3次（$x$ の2次と $y$ の1次の積）であるため、2次の項には含まれません。また、$x \cdot \left(-\frac{1}{2}y^{2}\right)$ も3次であるため、2次の項には含まれません。
            </div>
            
            <p>以上より、2次までの項をまとめると、</p>
            
            <div class="formula">
                $$f(x,y) = y + xy - \frac{1}{2}y^{2} + \cdots$$
            </div>
            
            <p>となります。ここで、$\cdots$ は3次以上の項を表します。</p>
        </div>
        
        <div class="step">
            <div class="step-title">（2）$f(x,y)=\sin(x+y^{2})$ について（4次まで）</div>
            <p>この関数は、$x+y^{2}$ という変数の組み合わせに対して $\sin$ 関数を適用した形になっています。$t = x+y^{2}$ とおくと、$f(x,y) = \sin t$ です。</p>
            
            <p>まず、$\sin t$ のマクローリン展開を確認します。$\sin t$ のマクローリン展開は、</p>
            
            <div class="formula">
                $$\sin t = t - \frac{1}{3!}t^{3} + \frac{1}{5!}t^{5} - \cdots = t - \frac{1}{6}t^{3} + \frac{1}{120}t^{5} - \cdots$$
            </div>
            
            <p>です。ここで、$3! = 6$、$5! = 120$ であることを用いました。</p>
            
            <p>4次の項までを求めるため、$t^{5}$ 以上の項は無視します。したがって、</p>
            
            <div class="formula">
                $$\sin t = t - \frac{1}{6}t^{3} + \cdots$$
            </div>
            
            <p>です。ここで、$\cdots$ は5次以上の項を表します。</p>
            
            <p>次に、$t = x+y^{2}$ を代入します。したがって、</p>
            
            <div class="formula">
                $$\sin(x+y^{2}) = (x+y^{2}) - \frac{1}{6}(x+y^{2})^{3} + \cdots$$
            </div>
            
            <p>となります。</p>
            
            <p>ここで、$(x+y^{2})^{3}$ を展開する必要があります。3乗の展開公式 $(a+b)^{3} = a^{3} + 3a^{2}b + 3ab^{2} + b^{3}$ を用いると、</p>
            
            <div class="formula">
                $$(x+y^{2})^{3} = x^{3} + 3x^{2}y^{2} + 3xy^{4} + y^{6}$$
            </div>
            
            <p>となります。ここで、各項の次数を確認します：</p>
            
            <ul>
                <li>$x^{3}$：3次</li>
                <li>$3x^{2}y^{2}$：4次（$x$ の2次と $y^{2}$ の2次の積）</li>
                <li>$3xy^{4}$：5次（$x$ の1次と $y^{4}$ の4次の積）</li>
                <li>$y^{6}$：6次</li>
            </ul>
            
            <div class="note">
                <strong>補足：</strong> 項 $x^{m}y^{n}$ の次数は $m+n$ です。したがって、$x^{2}y^{2}$ は $2+2=4$ 次、$xy^{4}$ は $1+4=5$ 次、$y^{6}$ は $0+6=6$ 次です。
            </div>
            
            <p>4次までの項を集めるため、$(x+y^{2})^{3}$ の展開において、4次以下の項のみを残します。したがって、</p>
            
            <div class="formula">
                $$(x+y^{2})^{3} = x^{3} + 3x^{2}y^{2} + \cdots$$
            </div>
            
            <p>となります。ここで、$\cdots$ は5次以上の項（$3xy^{4}$ と $y^{6}$）を表します。</p>
            
            <p>したがって、</p>
            
            <div class="formula">
                $$\sin(x+y^{2}) = (x+y^{2}) - \frac{1}{6}(x^{3} + 3x^{2}y^{2} + \cdots) + \cdots$$
            </div>
            
            <p>となります。これを展開すると、</p>
            
            <div class="formula">
                $$\sin(x+y^{2}) = x+y^{2} - \frac{1}{6}x^{3} - \frac{1}{6} \cdot 3x^{2}y^{2} + \cdots = x+y^{2} - \frac{1}{6}x^{3} - \frac{1}{2}x^{2}y^{2} + \cdots$$
            </div>
            
            <p>となります。ここで、$\frac{1}{6} \cdot 3 = \frac{3}{6} = \frac{1}{2}$ であることを用いました。</p>
            
            <p>各項の次数を確認します：</p>
            
            <ul>
                <li>$x$：1次</li>
                <li>$y^{2}$：2次</li>
                <li>$-\frac{1}{6}x^{3}$：3次</li>
                <li>$-\frac{1}{2}x^{2}y^{2}$：4次（$x$ の2次と $y^{2}$ の2次の積）</li>
            </ul>
            
            <p>したがって、4次までの項は、$x$、$y^{2}$、$-\frac{1}{6}x^{3}$、$-\frac{1}{2}x^{2}y^{2}$ です。</p>
            
            <div class="note">
                <strong>補足：</strong> 4次までの項を集める際は、各項の次数が $m+n \le 4$ となる項のみを残します。ここでは、1次、2次、3次、4次の項が含まれています。
            </div>
            
            <p>以上より、4次までの項をまとめると、</p>
            
            <div class="formula">
                $$f(x,y) = \sin(x+y^{2}) = x+y^{2} - \frac{1}{6}x^{3} - \frac{1}{2}x^{2}y^{2} + \cdots$$
            </div>
            
            <p>となります。ここで、$\cdots$ は5次以上の項を表します。</p>
        </div>
        
        <div class="verification">
            <div class="verification-title">【検証】</div>
            <p>計算した内容を検証します。</p>
            
            <p>まず、問題（1）の計算を確認します。$e^{x} = 1 + x + \frac{1}{2}x^{2} + \cdots$、$\log(1+y) = y - \frac{1}{2}y^{2} + \cdots$ の展開を正しく用いました。これらを掛け算する際、2次の項は $y$（1次）、$xy$（2次）、$-\frac{1}{2}y^{2}$（2次）のみです。$\frac{1}{2}x^{2} \cdot y$ や $x \cdot \left(-\frac{1}{2}y^{2}\right)$ は3次であるため、2次の項には含まれません。したがって、結果 $f(x,y) = y + xy - \frac{1}{2}y^{2} + \cdots$ は正しいです。</p>
            
            <p>次に、問題（2）の計算を確認します。$\sin t = t - \frac{1}{6}t^{3} + \cdots$ の展開を正しく用いました。$t = x+y^{2}$ を代入し、$(x+y^{2})^{3} = x^{3} + 3x^{2}y^{2} + 3xy^{4} + y^{6}$ を展開しました。4次までの項を集める際、$x$（1次）、$y^{2}$（2次）、$-\frac{1}{6}x^{3}$（3次）、$-\frac{1}{2}x^{2}y^{2}$（4次）のみを残しました。$3xy^{4}$ は5次、$y^{6}$ は6次であるため、4次の項には含まれません。したがって、結果 $f(x,y) = x+y^{2} - \frac{1}{6}x^{3} - \frac{1}{2}x^{2}y^{2} + \cdots$ は正しいです。</p>
            
            <p>以上より求めた結果の正しさを確認しました。</p>
        </div>
        
        <div class="answer-box">
            <div class="answer-title">【答】</div>
            <p>（1）$f(x,y)=e^{x}\log(1+y)$ について（2次まで）：</p>
            <p>$f(x,y) = y + xy - \frac{1}{2}y^{2} + \cdots$</p>
            <p>$e^{x} = 1 + x + \frac{1}{2}x^{2} + \cdots$、$\log(1+y) = y - \frac{1}{2}y^{2} + \cdots$ の展開を用いて、これらを掛け算し、2次の項までを集めます。1次の項は $y$、2次の項は $xy$ と $-\frac{1}{2}y^{2}$ です。</p>
            
            <p>（2）$f(x,y)=\sin(x+y^{2})$ について（4次まで）：</p>
            <p>$f(x,y) = x+y^{2} - \frac{1}{6}x^{3} - \frac{1}{2}x^{2}y^{2} + \cdots$</p>
            <p>$t = x+y^{2}$ とおき、$\sin t = t - \frac{1}{6}t^{3} + \cdots$ の展開を用います。$t = x+y^{2}$ を代入し、$(x+y^{2})^{3} = x^{3} + 3x^{2}y^{2} + \cdots$ を展開して、4次までの項を集めます。1次の項は $x$、2次の項は $y^{2}$、3次の項は $-\frac{1}{6}x^{3}$、4次の項は $-\frac{1}{2}x^{2}y^{2}$ です。</p>
        </div>
    </div>
</body>
</html>
